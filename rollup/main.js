!function(){"use strict";function e(e,t){e=e.replace(/<%-sUrl%>/g,encodeURIComponent(t.sUrl)).replace(/<%-sTitle%>/g,encodeURIComponent(t.sTitle)).replace(/<%-sDesc%>/g,encodeURIComponent(t.sDesc)).replace(/<%-sPic%>/g,encodeURIComponent(t.sPic));window.open(e)}function t(){$(".wx-share-modal").removeClass("in ready"),$("#share-mask").hide()}function o(t,o){"weibo"===t?e("http://service.weibo.com/share/share.php?url=<%-sUrl%>&title=<%-sTitle%>&pic=<%-sPic%>",o):"qq"===t?e("http://connect.qq.com/widget/shareqq/index.html?url=<%-sUrl%>&title=<%-sTitle%>&source=<%-sDesc%>",o):"douban"===t?e("https://www.douban.com/share/service?image=<%-sPic%>&href=<%-sUrl%>&name=<%-sTitle%>&text=<%-sDesc%>",o):"qzone"===t?e("http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=<%-sUrl%>&title=<%-sTitle%>&pics=<%-sPic%>&summary=<%-sDesc%>",o):"facebook"===t?e("https://www.facebook.com/sharer/sharer.php?u=<%-sUrl%>",o):"twitter"===t?e("https://twitter.com/intent/tweet?text=<%-sTitle%>&url=<%-sUrl%>",o):"google"===t?e("https://plus.google.com/share?url=<%-sUrl%>",o):"weixin"===t&&($(".wx-share-modal").addClass("in ready"),$("#share-mask").show())}!function(e){let t=e(".search-form-wrap"),o=!1,s=e(window);e(".nav-item-search").on("click",(()=>{var s;o||(o=!0,t.addClass("on"),s=function(){e(".local-search-input").focus()},setTimeout((function(){o=!1,s&&s()}),200))})),e(document).on("touchstart mousedown",(o=>{if("ri-search-line"==o.target.className||"搜索"==o.target.title)return;const s=e(".local-search");s.is(o.target)||0!==s.has(o.target).length||t.removeClass("on")})),e(".local-search").length&&e.getScript("/js/search.js",(function(){searchFunc("/search.xml","local-search-input","local-search-result")})),e(".share-outer").on("click",(()=>e(".share-wrap").fadeToggle())),e("img.lazy").lazyload({effect:"fadeIn"}),e("#gallery").justifiedGallery({rowHeight:200,margins:5}),e(document).ready((function(e){e(".anchor").on("click",(function(t){t.preventDefault(),e("main").animate({scrollTop:e(".cover").height()},"smooth")}))})),(()=>{const t=e("#totop");t.hide();s.on("scroll",(o=>{(o=>{e(o).scrollTop()>1e3?(t.css("display","block"),t.stop().fadeTo(150,.6)):(t.stop().fadeTo(150,0),t.css("display","none"))})(o.target)}));let o=0,r=0,a=null;function c(){r=s.scrollTop(),r==o&&(clearTimeout(a),t.unbind("click").one("click",(()=>{e("html, body").animate({scrollTop:0},800)})))}s.on("scroll",(function(){clearTimeout(a),a=setTimeout(c,300),o=s.scrollTop()}))})(),e(".article-entry").each((function(t){e(this).find("img").each((function(){if(e(this).parent().is("a"))return;const{alt:t}=this;t&&e(this).after('<span class="caption">'+t+"</span>")}))}));const r=e(".sidebar");function a(t){t?(e("body").addClass("darkmode"),e("#todark i").removeClass("ri-moon-line").addClass("ri-sun-line")):(e("body").removeClass("darkmode"),e("#todark i").removeClass("ri-sun-line").addClass("ri-moon-line"))}e(".navbar-toggle").on("click",(()=>{r.toggleClass("on"),e(".content").toggleClass("on")})),e(".content").on("touchstart mousedown",(()=>{window.innerWidth<=768&&(r.addClass("on"),e(".content").addClass("on"))})),e("#reward-btn").on("click",(()=>{e("#reward").fadeIn(150),e("#mask").fadeIn(150)})),e("#reward .close, #mask").on("click",(()=>{e("#mask").fadeOut(100),e("#reward").fadeOut(100)})),e("#todark").on("click",(()=>{1==localStorage.getItem("darkmode")?(a(0),localStorage.removeItem("darkmode")):(a(1),localStorage.setItem("darkmode",1))})),e("#changebg").on("click",(()=>{let t=e(".bg-img").attr("src"),o=e(".bg-img").data("sources").split(","),s=o.findIndex((e=>e==t));t=o[s+1]?o[s+1]:o[0],localStorage.setItem("bg_img_src",t),e(".bg-img").attr("src",t),Pace.restart()}))}(jQuery);(()=>{let e=document.querySelectorAll(".share-sns");if(!e||0===e.length)return;let s=window.location.href,r=document.querySelector("title").innerHTML,a=document.querySelectorAll(".article-entry img").length?document.querySelector(".article-entry img").getAttribute("src"):"";""===a||/^(http:|https:)?\/\//.test(a)||(a=window.location.origin+a),e.forEach((e=>{e.onclick=t=>{o(e.getAttribute("data-type"),{sUrl:s,sPic:a,sTitle:r,sDesc:r})}})),document.querySelector("#mask").onclick=t,document.querySelector(".modal-close").onclick=t})()}();
